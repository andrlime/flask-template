version: '3'

tasks:
  lint:
    cmds:
      - uv run ruff format --check .
      - uv run ruff check .
  format:
    cmds:
      - uv run ruff check --select I --fix .
      - uv run ruff format .
  strict-check:
    cmds:
      - uv run pyrefly check .
  checks:
    cmds:
      - task: format
      - task: lint
      - task: strict-check
  dev:
    env:
      PORT: 9000
    cmds:
      - docker build --target dev -t template-dev .
      - docker run -e PORT=$PORT -p $PORT:$PORT template-dev
  prod:
    env:
      PORT: 9000
    cmds:
      - docker build --target prod -t template-prod .
      - docker run -e PORT=$PORT -p $PORT:$PORT template-prod
